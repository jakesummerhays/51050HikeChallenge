<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <!-- Responsive Meta Tag for Mobile -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>hikechallenge.org</title>

  <style>
    /* --------------------------
       GLOBAL RESETS & BASE
    --------------------------- */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      font-family: Arial, sans-serif;
      background-color: #000;
      color: #fff;
    }
    a {
      text-decoration: none;
      color: inherit;
    }

    /* --------------------------
       HEADER (TITLE & LOGO)
    --------------------------- */
    .header {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      margin: 10px auto 15px auto;
      max-width: 95%;
    }
    .site-title {
      font-size: 2em;
      font-weight: bold;
      color: #00BFFF;
      margin-bottom: 10px;
    }
    .logo {
      max-width: 350px;
      height: auto;
    }

    /* --------------------------
       DASHBOARD (WHITE BORDER, TABULAR LAYOUT)
    --------------------------- */
    .dashboard {
      width: 80%;  
      max-width: 560px;
      margin: 0 auto 20px auto;
      border: 1px solid #fff; /* White border */
      border-radius: 8px;
      padding: 20px;
      text-align: center; /* We'll center the table container as well */
    }
    .dashboard-table {
      display: table;
      margin: 0 auto; /* Center the table itself */
    }
    .dashboard-row {
      display: table-row;
    }
    .dashboard-cell-label,
    .dashboard-cell-count {
      display: table-cell;
      padding: 8px 15px;
      text-align: right; /* Right-align text in both columns */
      vertical-align: middle;
    }
    .dashboard-cell-label {
      font-size: 1.1em;
    }
    .dashboard-cell-count {
      font-size: 1.5em;
      font-weight: bold;
      width: 60px; /* Enough space for numbers to align nicely */
    }

    /* Submit link below the dashboard */
    .submit-link {
      text-align: center;
      margin-bottom: 20px;
    }
    .button {
      display: inline-block;
      padding: 10px 20px;
      background-color: #00BFFF;
      color: #000;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      transition: background 0.3s;
      text-decoration: none;
    }
    .button:hover {
      background-color: #87CEFA;
    }

    /* --------------------------
       SUMMARY PARAGRAPHS
    --------------------------- */
    .summary {
      max-width: 700px;
      margin: 0 auto 20px auto;
      padding: 15px;
      line-height: 1.6;
    }
    .summary p {
      font-size: 1.1em;
      margin-bottom: 10px;
    }

    /* --------------------------
       LIABILITY DISCLAIMER
    --------------------------- */
    .disclaimer {
      max-width: 700px;
      margin: 0 auto;
      padding: 0 15px 15px;
      color: #ccc;
      font-size: 0.9em;
      line-height: 1.4;
      text-align: left;
    }

    /* --------------------------
       FINISHERS
    --------------------------- */
    .finishers {
      max-width: 700px;
      margin: 20px auto 40px auto;
      padding: 10px;
      text-align: left;
    }
    .finishers h3 {
      text-align: center;
      margin-bottom: 10px;
      font-size: 1.3em;
      color: #fff;
    }
    .name-list {
      display: flex;
      flex-direction: column;
      gap: 6px;
      width: 100%;
      word-wrap: break-word;
    }
    .name-item {
      background-color: #1a1a1a;
      padding: 5px 10px;
      border-radius: 4px;
    }

    /* --------------------------
       FOOTER (Hidden)
    --------------------------- */
    .footer {
      display: none;
    }

    /* --------------------------
       RESPONSIVE MEDIA QUERY
    --------------------------- */
    @media (max-width: 600px) {
      .dashboard,
      .summary,
      .disclaimer,
      .finishers {
        width: 90%;
        margin: 10px auto;
        padding: 15px;
      }
      .site-title {
        font-size: 1.5em;
      }
      .logo {
        max-width: 70%;
      }
      .dashboard-cell-count {
        width: 50px;
      }
    }
  </style>
</head>
<body>

  <!-- HEADER -->
  <div class="header">
    <div class="site-title">hikechallenge.org</div>
    <img class="logo" src="logo2.jpg" alt="hikechallenge.org Logo" />
  </div>

  <!-- DASHBOARD (white border, table layout) -->
  <div class="dashboard">
    <div class="dashboard-table">
      <div class="dashboard-row">
        <div class="dashboard-cell-label">5 Mile Hikes</div>
        <div class="dashboard-cell-count" id="fiveMileCount">0</div>
      </div>
      <div class="dashboard-row">
        <div class="dashboard-cell-label">10 Mile Hikes</div>
        <div class="dashboard-cell-count" id="tenMileCount">0</div>
      </div>
      <div class="dashboard-row">
        <div class="dashboard-cell-label">50 Mile Hikes</div>
        <div class="dashboard-cell-count" id="fiftyMileCount">0</div>
      </div>
      <div class="dashboard-row">
        <div class="dashboard-cell-label">Total Miles Hiked</div>
        <div class="dashboard-cell-count" id="totalMilesHiked">0</div>
      </div>
    </div>
  </div>

  <!-- Submit button below the dashboard -->
  <div class="submit-link">
    <a class="button" href="https://docs.google.com/forms/d/e/1FAIpQLScI2HN5KbJOdWM2WBOHyMxiU0ML5muFDZ3KDP9nkqS3sRoWwg/viewform?usp=dialog" target="_blank">
      Submit Your Hike
    </a>
  </div>

  <!-- SUMMARY -->
  <div class="summary">
    <p>
      In 2025 we started hikechallenge.org with the vision that it becomes a
      nationwide movement to inspire people across a range of fitness levels to get into Nature,
      experience hiking, improve our Health, build Community, and grow in Confidence.
    </p>
    <p>
      This website will keep track of the total number of hike finishers in each of the 3 distances.
      It is our hope that hikechallenge.org participants share their stories with others so the
      movement and its benefits spread.
    </p>
    <p>
      Rememberâ€”after you have completed your hike to Submit Your Hike so that it is counted
      and your name shows up on our Finisher list.
    </p>
  </div>

  <!-- DISCLAIMER -->
  <div class="disclaimer">
    <p>
      By submitting YOUR HIKE to hikechallenge.org you acknowledge that your hike was completely voluntary.
      You understand and accept that you do so at your own risk. hikechallenge.org not liable for any
      accidents, injuries, or other incidents that may occur during your hike. If you have any concerns
      about your health or ability to participate, please consult a medical professional before starting.
    </p>
  </div>

  <!-- FINISHERS -->
  <div class="finishers">
    <h3>Finishers</h3>
    <div class="name-list" id="nameList"></div>
  </div>

  <script>
    /*************************************************************
     * DO_GET_URL from your Apps Script (ends in /exec)
     *************************************************************/
    const DO_GET_URL = "https://script.google.com/macros/s/AKfycbwDfy9-YWF4J8AUX-L-lvF_oeDWER66K3p9CnM2cPvUmTPrkte45PkZ7ixMvgHcst5fMg/exec";

    /*************************************************************
     * FETCH DATA FROM SHEETS (doGet) TO UPDATE DASHBOARD
     *************************************************************/
    async function fetchHikeDataFromSheet() {
      try {
        const response = await fetch(DO_GET_URL); // GET request
        const submissions = await response.json(); // array of objects

        // Reset counters
        let fiveCount = 0;
        let tenCount = 0;
        let fiftyCount = 0;

        // Clear existing list
        document.getElementById('nameList').innerHTML = "";

        // Tally & display
        submissions.forEach((entry, index) => {
          // Count the hike distances
          if (entry.hikeLength === "5 Mile Hike") fiveCount++;
          else if (entry.hikeLength === "10 Mile Hike") tenCount++;
          else if (entry.hikeLength === "50 Mile Hike") fiftyCount++;

          // The finisher's position is index+1 (1-based)
          const finisherNumber = index + 1;

          // Extract only YYYY-MM-DD from the timestamp (e.g. "2025-03-21T07:00:00.000Z" => "2025-03-21")
          const dateOnly = entry.timestamp.split("T")[0];

          // e.g., "1) Jacob Summerhays - 2025-03-21"
          const nameDiv = document.createElement('div');
          nameDiv.classList.add('name-item');
          nameDiv.textContent = `${finisherNumber}) ${entry.name} - ${dateOnly}`;
          document.getElementById('nameList').appendChild(nameDiv);
        });

        // Update the counters on the dashboard
        document.getElementById('fiveMileCount').textContent = fiveCount;
        document.getElementById('tenMileCount').textContent = tenCount;
        document.getElementById('fiftyMileCount').textContent = fiftyCount;

        // Calculate total miles
        const totalMiles = (fiveCount * 5) + (tenCount * 10) + (fiftyCount * 50);
        document.getElementById('totalMilesHiked').textContent = totalMiles;

      } catch (err) {
        console.error("Failed to fetch data from Sheets:", err);
      }
    }

    // On page load, fetch existing data from Sheets
    window.onload = fetchHikeDataFromSheet;
  </script>
</body>
</html>