<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <!-- Responsive Meta Tag for Mobile -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>hikechallenge.org</title>
  <style>
    /* --------------------------
       GLOBAL RESETS & BASE
    --------------------------- */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      font-family: Arial, sans-serif;
      background-color: #000;
      color: #fff;
    }
    a {
      text-decoration: none;
      color: inherit;
    }

    /* --------------------------
       HEADER (TITLE & LOGO)
    --------------------------- */
    .header {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      margin: 10px auto 15px auto;
      max-width: 95%;
    }
    .site-title {
      font-size: 2em;
      font-weight: bold;
      color: #00BFFF;
      margin-bottom: 10px;
    }
    .logo {
      max-width: 350px;
      height: auto;
    }

    /* --------------------------
       DASHBOARD (WHITE BORDER, TABULAR LAYOUT, CENTERED)
    --------------------------- */
    .dashboard {
      width: 80%;  
      max-width: 560px;
      margin: 0 auto 20px auto;
      border: 1px solid #fff;
      border-radius: 8px;
      padding: 20px;
      text-align: center;
    }
    .dashboard-table {
      display: table;
      margin: 0 auto;
    }
    .dashboard-row {
      display: table-row;
    }
    .dashboard-cell-label,
    .dashboard-cell-count {
      display: table-cell;
      padding: 8px 15px;
      vertical-align: middle;
    }
    .dashboard-cell-label {
      font-size: 1.1em;
      text-align: right;
    }
    .dashboard-cell-count {
      font-size: 1.5em;
      font-weight: bold;
      text-align: right;
      width: 60px;
    }

    /* Submit link outside the dashboard */
    .submit-link {
      text-align: center;
      margin-bottom: 20px;
    }
    .button {
      display: inline-block;
      padding: 10px 20px;
      background-color: #00BFFF;
      color: #000;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      transition: background 0.3s;
      text-decoration: none;
    }
    .button:hover {
      background-color: #87CEFA;
    }

    /* --------------------------
       SUMMARY PARAGRAPHS
    --------------------------- */
    .summary {
      max-width: 700px;
      margin: 0 auto 20px auto;
      padding: 15px;
      line-height: 1.6;
    }
    .summary p {
      font-size: 1.1em;
      margin-bottom: 10px;
    }

    /* --------------------------
       LIABILITY DISCLAIMER
    --------------------------- */
    .disclaimer {
      max-width: 700px;
      margin: 0 auto;
      padding: 0 15px 15px;
      color: #ccc;
      font-size: 0.9em;
      line-height: 1.4;
      text-align: left;
    }

    /* --------------------------
       FINISHERS
    --------------------------- */
    .finishers {
      max-width: 700px;
      margin: 20px auto 40px auto;
      padding: 10px;
      text-align: left;
    }
    .finishers h3 {
      text-align: center;
      margin-bottom: 10px;
      font-size: 1.3em;
      color: #fff;
    }
    .name-list {
      display: flex;
      flex-direction: column;
      gap: 6px;
      width: 100%;
      word-wrap: break-word;
    }
    .name-item {
      background-color: #1a1a1a;
      padding: 5px 10px;
      border-radius: 4px;
    }

    /* --------------------------
       FOOTER (HIDDEN)
    --------------------------- */
    .footer {
      display: none;
    }

    /* --------------------------
       RESPONSIVE MEDIA QUERY
    --------------------------- */
    @media (max-width: 600px) {
      .dashboard,
      .summary,
      .disclaimer,
      .finishers {
        width: 90%;
        margin: 10px auto;
        padding: 15px;
      }
      .site-title {
        font-size: 1.5em;
      }
      .logo {
        max-width: 70%;
      }
      .dashboard-cell-count {
        width: 50px;
      }
    }
  </style>
</head>
<body>

  <!-- HEADER -->
  <div class="header">
    <div class="site-title">hikechallenge.org</div>
    <img class="logo" src="logo2.jpg" alt="hikechallenge.org Logo" />
  </div>

  <!-- DASHBOARD (white border, table layout, centered) -->
  <div class="dashboard">
    <div class="dashboard-table">
      <div class="dashboard-row">
        <div class="dashboard-cell-label">5 Mile Hikes</div>
        <div class="dashboard-cell-count" id="fiveMileCount">0</div>
      </div>
      <div class="dashboard-row">
        <div class="dashboard-cell-label">10 Mile Hikes</div>
        <div class="dashboard-cell-count" id="tenMileCount">0</div>
      </div>
      <div class="dashboard-row">
        <div class="dashboard-cell-label">50 Mile Hikes</div>
        <div class="dashboard-cell-count" id="fiftyMileCount">0</div>
      </div>
      <div class="dashboard-row">
        <div class="dashboard-cell-label">Total Miles Hiked</div>
        <div class="dashboard-cell-count" id="totalMilesHiked">0</div>
      </div>
    </div>
  </div>

  <!-- Submit button now placed below the dashboard -->
  <div class="submit-link">
    <a class="button" href="https://docs.google.com/forms/d/e/1FAIpQLScI2HN5KbJOdWM2WBOHyMxiU0ML5muFDZ3KDP9nkqS3sRoWwg/viewform?usp=dialog" target="_blank">
      Submit Your Hike
    </a>
  </div>

  <!-- SUMMARY -->
  <div class="summary">
    <p>
      In 2025 we started hikechallenge.org with the vision that it becomes a
      nationwide movement to inspire people across a range of fitness levels to get into Nature,
      experience hiking, improve our Health, build Community, and grow in Confidence.
    </p>
    <p>
      This website will keep track of the total number of hike finishers in each of the 3 distances.
      It is our hope that hikechallenge.org participants share their stories with others so the
      movement and its benefits spread.
    </p>
    <p>
      Rememberâ€”after you have completed your hike to Submit Your Hike so that it is counted
      and your name shows up on our Finisher list.
    </p>
  </div>

  <!-- DISCLAIMER -->
  <div class="disclaimer">
    <p>
      By submitting YOUR HIKE to hikechallenge.org you acknowledge that your hike was completely voluntary.
      You understand and accept that you do so at your own risk. hikechallenge.org not liable for any
      accidents, injuries, or other incidents that may occur during your hike. If you have any concerns
      about your health or ability to participate, please consult a medical professional before starting.
    </p>
  </div>

  <!-- FINISHERS -->
  <div class="finishers">
    <h3>Finishers</h3>
    <div class="name-list" id="nameList"></div>
  </div>

  <script>
    /*************************************************************
     * DO_GET_URL from your Apps Script (ends in /exec)
     *************************************************************/
    const DO_GET_URL = "https://script.google.com/macros/s/AKfycbwDfy9-YWF4J8AUX-L-lvF_oeDWER66K3p9CnM2cPvUmTPrkte45PkZ7ixMvgHcst5fMg/exec";

    /*************************************************************
     * State Abbreviations (if needed)
     *************************************************************/
    const stateAbbreviations = {
      "Alabama": "AL",
      "Alaska": "AK",
      "Arizona": "AZ",
      "Arkansas": "AR",
      "California": "CA",
      "Colorado": "CO",
      "Connecticut": "CT",
      "Delaware": "DE",
      "Florida": "FL",
      "Georgia": "GA",
      "Hawaii": "HI",
      "Idaho": "ID",
      "Illinois": "IL",
      "Indiana": "IN",
      "Iowa": "IA",
      "Kansas": "KS",
      "Kentucky": "KY",
      "Louisiana": "LA",
      "Maine": "ME",
      "Maryland": "MD",
      "Massachusetts": "MA",
      "Michigan": "MI",
      "Minnesota": "MN",
      "Mississippi": "MS",
      "Missouri": "MO",
      "Montana": "MT",
      "Nebraska": "NE",
      "Nevada": "NV",
      "New Hampshire": "NH",
      "New Jersey": "NJ",
      "New Mexico": "NM",
      "New York": "NY",
      "North Carolina": "NC",
      "North Dakota": "ND",
      "Ohio": "OH",
      "Oklahoma": "OK",
      "Oregon": "OR",
      "Pennsylvania": "PA",
      "Rhode Island": "RI",
      "South Carolina": "SC",
      "South Dakota": "SD",
      "Tennessee": "TN",
      "Texas": "TX",
      "Utah": "UT",
      "Vermont": "VT",
      "Virginia": "VA",
      "Washington": "WA",
      "West Virginia": "WV",
      "Wisconsin": "WI",
      "Wyoming": "WY"
    };

    /*************************************************************
     * Function to Render the Dashboard
     *************************************************************/
    function renderDashboard(submissions) {
      // Reset counters
      let fiveCount = 0;
      let tenCount = 0;
      let fiftyCount = 0;
      // Clear existing list
      const nameListElem = document.getElementById('nameList');
      nameListElem.innerHTML = "";

      // Process each submission
      submissions.forEach((entry, index) => {
        if (entry.hikeLength === "5 Mile Hike") fiveCount++;
        else if (entry.hikeLength === "10 Mile Hike") tenCount++;
        else if (entry.hikeLength === "50 Mile Hike") fiftyCount++;

        // For display, only show the date (YYYY-MM-DD)
        const dateOnly = entry.timestamp.split("T")[0];
        // Finisher number is based on index (1-based)
        const finisherNumber = index + 1;
        // Example: "1) Jacob Summerhays - 2025-03-21"
        const nameDiv = document.createElement('div');
        nameDiv.classList.add('name-item');
        nameDiv.textContent = `${finisherNumber}) ${entry.name} - ${dateOnly}`;
        nameListElem.appendChild(nameDiv);
      });

      // Update counters on the dashboard
      document.getElementById('fiveMileCount').textContent = fiveCount;
      document.getElementById('tenMileCount').textContent = tenCount;
      document.getElementById('fiftyMileCount').textContent = fiftyCount;

      // Calculate total miles
      const totalMiles = (fiveCount * 5) + (tenCount * 10) + (fiftyCount * 50);
      document.getElementById('totalMilesHiked').textContent = totalMiles;
    }

    /*************************************************************
     * FETCH DATA FROM SHEETS (doGet) TO UPDATE DASHBOARD
     *************************************************************/
    async function fetchHikeDataFromSheet() {
      try {
        const response = await fetch(DO_GET_URL); // GET request
        const submissions = await response.json(); // array of objects

        // Cache data locally to avoid showing zeros on subsequent visits
        localStorage.setItem("hikeDashboardData", JSON.stringify(submissions));
        renderDashboard(submissions);
      } catch (err) {
        console.error("Failed to fetch data from Sheets:", err);
      }
    }

    // On page load, first try to render cached data, then fetch new data
    window.onload = function() {
      const cached = localStorage.getItem("hikeDashboardData");
      if (cached) {
        renderDashboard(JSON.parse(cached));
      }
      fetchHikeDataFromSheet();
    };
  </script>
</body>
</html>